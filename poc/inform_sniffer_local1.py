# -*- coding: utf-8 -*-
import base64
import json
from struct import *

import zlib
from Crypto.Cipher import AES
from binascii import a2b_hex
#from flask import Flask, request

from inform import packet_decode,packet_encode

from Crypto.Cipher import AES
import binascii

data="\x54\x4e\x42\x55\x00\x00\x00\x00\x4c\xed\xfb\xbc\x34\x75\x00\x0b" 
data=data+"\xf4\xfc\x8e\x27\x53\x0c\x2c\x53\xca\x18\xeb\x40\x9e\x5f\x57\xdf" 
data=data+"\x00\x00\x00\x01\x00\x00\x02\xc4\xd6\xa4\x2b\x99\x45\x1e\xe9\x99" 
data=data+"\x7a\x20\x4e\x63\x23\x19\x12\x71\x89\x4b\xf8\x6d\x50\x28\xe9\x2a" 
data=data+"\x7a\xbc\x51\xfb\x82\xc9\xf2\xa2\x92\x3c\xcc\x84\x1b\x68\xfb\x93" 
data=data+"\x37\x4b\xd4\xb8\x2a\x3a\xaa\x4a\x10\xce\xc9\x49\x54\x5b\x73\xde" 
data=data+"\xb2\x77\x1b\xe0\xe3\x6c\x55\x11\xbe\xf6\x26\xc1\x3b\xc9\x38\xfe" 
data=data+"\x7c\x98\x71\x9a\x67\x83\x42\x99\x58\xbc\x1d\xe9\x8d\x53\x29\xa2" 
data=data+"\x2f\x8f\xe5\xa3\x5f\x74\x8b\x0a\x6a\xc2\x35\x92\xd9\x99\xf8\x8d" 
data=data+"\x8d\xb4\x64\x4f\x47\xee\xa3\x5a\x6d\x2b\x72\xb7\xc4\xd9\xee\xef" 
data=data+"\x15\x21\xdf\x3e\x1e\xf8\x8d\x29\x15\xc4\x40\x29\x9c\x14\xc8\x4d" 
data=data+"\xae\x0b\x16\x4a\xfd\x41\x7f\x49\x45\x1e\x4d\xf3\xad\xd0\xf1\x52" 
data=data+"\x98\xdb\x07\x3f\x47\xd4\xef\xb9\xb0\x1b\x97\xbe\x08\xea\x01\xfc" 
data=data+"\x9c\x29\xf5\xb2\x9f\x14\x04\x22\x97\x69\x28\x1a\x22\x69\xf9\xd2" 
data=data+"\x68\x0f\xea\x84\xdb\xd1\x5e\x10\x89\x61\x50\xf0\x5b\x52\x8d\x99" 
data=data+"\x5d\x85\x7a\x96\x95\x73\xb6\x72\x12\xce\x71\x60\xea\xc6\x7e\x7b" 
data=data+"\x9b\x86\xdd\x24\x2a\xf7\xb6\x7a\x3c\x34\x8e\x26\x08\x9e\x57\xd5" 
data=data+"\xb0\xdf\x98\xfa\x06\x28\xf7\x78\x5b\x91\x9e\xf2\x78\xbf\xc6\x47" 
data=data+"\xf7\x6d\xb8\x36\xdc\x5e\xf9\xef\x8b\x12\xeb\x74\x65\xd3\x17\xcf" 
data=data+"\xf6\xa1\xb6\xb5\xfc\x6a\x2c\xdc\x3c\xcb\x6b\x99\x93\x9f\xbb\x84" 
data=data+"\x47\xa0\x41\xce\x1f\xcb\x47\xf7\x0e\x5e\xe7\xeb\x74\x48\x27\xa6" 
data=data+"\x21\x59\xff\xc4\xe6\xc6\x2d\xef\xdc\x5f\xae\x3f\xec\xd7\xcc\xe1" 
data=data+"\x9b\x2f\x8b\x91\x08\xc1\x43\x64\x36\x80\x0b\xf3\x47\xb6\x50\xe4" 
data=data+"\x69\xd6\xc7\xf8\x89\x18\x66\xb4\x63\x58\x4b\x99\xed\xc0\x63\x90" 
data=data+"\x1f\x07\xe2\xb3\xc1\x3a\x07\x96\x15\xa1\xc6\xa1\x73\x53\x8a\x43" 
data=data+"\x32\x2d\xbc\x04\xe5\xd1\x24\xa5\x77\x49\x5d\x1d\x9e\xd8\x9c\x03" 
data=data+"\x24\x2e\xbf\x7e\xe1\xbd\xf8\x25\xe4\xfa\xa5\x12\xee\xf0\xc8\x60" 
data=data+"\x17\x07\xdc\x01\x2d\xba\xd3\x88\xae\x40\xcc\x7a\xad\x80\x72\xba" 
data=data+"\x67\xee\xfc\x8b\x59\x7d\x92\xcf\x4d\x5f\x94\xb3\x10\x35\x7d\x57" 
data=data+"\xb6\xe7\x38\x99\xa3\x26\xb7\x70\xc8\xc4\xb6\x80\x0e\x62\x86\x47" 
data=data+"\xf5\x91\x1d\x97\x27\xb7\xd5\xaa\x85\x82\x54\x7b\xe8\x34\x7c\x3b" 
data=data+"\xe2\x35\xa7\x16\x91\x44\x36\x9d\x50\x0f\xe8\xd7\xaf\xf8\x1e\xb6" 
data=data+"\xd2\x63\x68\xa9\x60\x30\x69\x38\x8b\x46\xd9\x8e\x02\x55\xd2\x08" 
data=data+"\x0e\x58\xcd\x09\x6e\x81\x25\x3e\x90\xf4\xb4\x29\x42\x6b\x03\xab" 
data=data+"\xfd\xfc\xb4\xe2\x61\x97\xaa\x6a\xb0\xf9\x58\xfb\xf1\x42\x99\xac" 
data=data+"\x12\x0b\x5c\xf8\xeb\x60\x5f\xa7\x6a\x73\xfa\x41\x70\x5d\xd2\xd7" 
data=data+"\x36\x7a\xc5\x9b\xb5\xbd\xcb\xa6\xdc\x38\x19\xe9\x85\xf6\xd1\xf9" 
data=data+"\x66\x4d\x17\xf9\xb2\x66\x39\x18\x2c\x23\xa7\x17\x4a\xaa\x4f\xae" 
data=data+"\x4a\x1b\xf2\x2d\x94\xd7\xe8\x6e\x8d\x79\x69\x08\x68\x79\xed\x35" 
data=data+"\x03\xf8\xf2\x5c\x84\x50\x18\xc6\x49\x6f\xcc\x6b\x85\x61\x4b\x72" 
data=data+"\xda\x19\x37\x07\x66\x83\x0d\x01\xed\xef\x57\xed\xec\x7e\x03\x33" 
data=data+"\x0d\x34\x21\xee\x53\xd4\x3f\x04\x7d\x47\xa5\x1e\x9f\xb6\xdf\xee" 
data=data+"\xca\x43\x1a\xc7\x63\x24\x9f\x0e\x43\xa8\x77\x1d\x78\x61\x40\xc9" 
data=data+"\xd9\x9e\xe8\x88\xd6\x01\xd3\xa0\xd0\x3b\x01\xf8\x4c\x2a\x0e\x26" 
data=data+"\x90\x06\x44\x3f\xee\x6c\xfa\x2d\x6f\xe4\xbd\x9b\xb1\x25\xec\x78" 
data=data+"\x00\x0c\x83\x80\xf6\xf2\xfb\x06\xfb\x8b\xaf\x71\x81\x97\x80\x9f" 
data=data+"\x7c\xc9\x4b\x4b\x98\x93\xae\xee\xd2\xa2\x8b\x9e"

payload,iv = packet_decode(a2b_hex("2e98f16d3fb22739be92437644e2b81c"), data)
 #DF44776659A10624A8084BAE30C7D2E0
print(json.loads(payload))

payload = packet_encode(a2b_hex("2e98f16d3fb22739be92437644e2b81c"), payload,iv)

