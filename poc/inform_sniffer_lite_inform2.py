# -*- coding: utf-8 -*-
import base64
import json
from struct import *

import zlib
from Crypto.Cipher import AES
from binascii import a2b_hex
#from flask import Flask, request

from inform import packet_decode,packet_encode

from Crypto.Cipher import AES
import binascii

data="\x54\x4e\x42\x55\x00\x00\x00\x00\x78\x8a\x20\xdc\x43\x89\x00\x0b" 
data=data+"\x7c\x30\x7b\xb0\xe2\xc2\x3f\x12\x86\x70\x16\x17\x9d\x05\x5e\x37" 
data=data+"\x00\x00\x00\x01\x00\x00\x01\xfe\xf8\xe2\xf1\xe8\x10\xa8\xf0\x18" 
data=data+"\x1c\x53\xc2\x88\x00\xc4\xc0\x0a\x15\xba\x10\x19\xf3\xb8\xf7\x75" 
data=data+"\xe8\x00\xbc\x01\x65\x0b\x3e\x04\x2a\xeb\x3f\xde\x41\x78\xde\x65" 
data=data+"\x69\xd5\x45\x70\x2f\xaf\x86\xb6\x11\x4d\xfb\x56\x91\x6c\xdb\x8f" 
data=data+"\x7b\x3e\x1c\xef\x44\xbb\x3b\x20\xcd\x82\x2f\xe8\x22\x63\xf2\xcd" 
data=data+"\x6a\x78\x42\xb3\xda\xe1\x95\xf3\xb2\xc7\xfb\x0e\x4f\xdf\x0c\xea" 
data=data+"\x25\xb6\x09\xdc\xa5\x9a\x17\x61\x5b\xff\xf5\x1c\x78\xb5\x29\x1e" 
data=data+"\x9d\x71\x6c\xa8\xbd\x81\xac\xbb\x56\xa7\xba\xd7\x4a\x33\x0f\xf5" 
data=data+"\xe1\x4e\x22\x74\x54\x34\x43\x8d\xfb\x36\x43\x95\xd8\xd7\xdc\x70" 
data=data+"\x37\x7b\x2d\x27\xbc\xd5\x7e\x15\x00\x19\x74\xbf\xf2\xe5\x0b\x8e" 
data=data+"\x4f\x70\x11\x8b\x9e\x82\xb8\x2f\xee\x5a\xdb\xde\x24\x7f\x20\x19" 
data=data+"\x15\xb7\x62\xd2\x2c\x32\xf3\x6b\xaa\x3d\x75\x24\xa2\x3b\x90\x20" 
data=data+"\x39\x89\x68\x14\xfe\xf1\xf5\x82\xb0\x8d\xf6\x4f\x45\x08\x33\x71" 
data=data+"\x4c\x4c\x3b\xdc\xa5\x9d\xed\xc9\x71\xa3\x46\x2d\x53\xc9\x95\x49" 
data=data+"\x5e\x2e\x3e\x88\x48\x19\x02\x80\xa2\x0f\x87\x8b\xc3\x30\x98\xe9" 
data=data+"\x72\x2c\x55\xe2\xb1\xb1\x94\x00\x24\x20\xcc\xa4\xba\x2d\x7c\x29" 
data=data+"\x86\x17\xcb\xaa\x93\x61\xca\x54\x85\xff\x7a\x1c\xcb\x30\xcc\x79" 
data=data+"\x53\x4c\xbe\x8a\x0d\xd8\x7e\x33\x56\x7c\xc9\x06\xec\x33\xa9\x8a" 
data=data+"\xcc\x89\x06\x8d\xec\x09\xcb\x06\xe3\xb4\xc1\x55\x82\x00\x87\x14" 
data=data+"\x96\x88\x8c\x25\x0b\x48\xdd\xc8\x53\x3d\xa1\x65\x80\x6b\xf7\x80" 
data=data+"\x7a\xc6\x8a\xf7\xf3\x71\xcb\x1c\xbc\x88\xa3\xb4\xbc\xc7\xc7\xfb" 
data=data+"\x33\xc8\x19\x54\x90\xa2\xf2\x9d\x35\x7f\x7d\xcf\xc7\xec\x7a\x12" 
data=data+"\xaa\x37\x06\x6c\x1c\xb9\xb5\xef\x93\xf5\x76\xc2\xe5\x39\x6b\x90" 
data=data+"\xeb\x6e\x94\xa0\x6c\x25\x19\x49\xff\x2e\xd5\x42\x90\xfe\x86\x5b" 
data=data+"\x69\xd6\xe3\x31\x06\xed\x07\xa7\x95\x97\xa4\x1c\xd3\x78\x0e\x78" 
data=data+"\x67\x2a\x32\x16\x3e\x6c\x3c\x94\xe3\xa4\x8b\x28\x46\xf8\x78\xdd" 
data=data+"\x1d\x58\x2d\x0a\xa0\xf4\x84\xfb\xdf\x08\x57\xb6\x68\xb9\x75\xd1" 
data=data+"\x44\xa1\xbd\x2d\x0e\x73\xc5\xd0\xd9\xba\x89\x47\xad\x56\xd3\x72" 
data=data+"\xf8\xf8\x25\x6c\x2a\x29\xaa\x44\xf5\xb5\xea\x77\xa0\xbc\xe6\xca" 
data=data+"\x1b\xf9\x65\xcb\xb2\xcd\xcb\xc9\x41\x98\x1a\xe0\x22\x5e\x5e\x42" 
data=data+"\x74\x54\xea\x54\x8f\xd9\xb8\x68\xfe\x16\xfd\xf3\xf3\x12\xfd\x56" 
data=data+"\x3a\x31\xbe\x05\x29\x84\xec\xcc\xa9\x07\x1c\xaf\xc4\xcb\x23\x5d" 
data=data+"\xc4\xe8\xaf\x16\x85\x41"


#payload,iv = packet_decode(a2b_hex("EE44CCE96733A3F8207F19EEB0813C57"), data)
#j = json.loads(payload)
#print(j)
#dataa=  packet_encode(a2b_hex("EE44CCE96733A3F8207F19EEB0813C57"), payload,iv,data[0:40])
#print(binascii.hexlify(dataa))

#print(binascii.hexlify(data))
payload,iv = packet_decode(a2b_hex("EE44CCE96733A3F8207F19EEB0813C57"), data)
j = json.loads(payload)
print(len(payload))
print(binascii.hexlify(data[0:40]))
print(j)
print("--------------")
dataa=  packet_encode(a2b_hex("EE44CCE96733A3F8207F19EEB0813C57"), payload,iv,data[0:40])
print(binascii.hexlify(dataa))
print("--------------")
print(binascii.hexlify(data))
print("--------------")
print(binascii.hexlify(dataa)==binascii.hexlify(data))


